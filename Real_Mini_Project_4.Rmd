---
title: "Mini_Project_4"
author: "Paige E. Patrick"
date: "12/11/2017"
output: html_document
---

According to Forbes, for every two dollars spent making a film, studios spend another dollar on marketing. Is this money all for nothing? IMDb genre categorization often conflicts with how a movie is marketed. We look at this disparity and its impact on how movies are perceived.

Production companies spend time and effort controlling how a movie is marketed, in order to attract the attention of certain audiences and increase sales for the movie. Because IMDb does not gain profit from movie sales, they do not need to be concerned with appealing to certain audiences. This allows IMDb to be more flexible with how they categorize movies on their website. We will be looking at a couple of the most popular movies over the past sixty years to see if IMDb has categorized them the same way they were marketed when they were first released. 

```{r, include = FALSE}
library(mdsr)
library(RMySQL)
db <- dbConnect_scidb(dbname = "imdb")
```

```{r, include = FALSE, message = FALSE, warning = FALSE}
library(ggplot2)
library(tidyverse)
library(dbplyr)
library(knitr)
```

To help determine what movies we would be analyzing over the past 80 years, we found the movie with the highest number of recorded votes, up to the time that the data was collected for SQL. 

```{r}
sql_1940_data <- db %>%
dbGetQuery("SELECT t.title, t.production_year, 
mi.movie_id,
mii.info_type_id, mii.info 
FROM title t
LEFT JOIN movie_info mi ON mi.movie_id = t.id
LEFT JOIN movie_info mi2 ON mi2.movie_id = t.id
LEFT JOIN movie_info_idx mii ON mii.movie_id = t.id
WHERE kind_id = 1 AND production_year = 1940
  AND mi.info_type_id = 1 AND mi2.info = 'USA'
  AND mii.info_type_id = 100
  AND mii.info > 100000
  ORDER BY mii.info DESC;")
```

```{r}
sql_1960_data <- db %>%
dbGetQuery("SELECT t.title, t.production_year, 
mi.movie_id,
mii.info_type_id, mii.info 
FROM title t
LEFT JOIN movie_info mi ON mi.movie_id = t.id
LEFT JOIN movie_info mi2 ON mi2.movie_id = t.id
LEFT JOIN movie_info_idx mii ON mii.movie_id = t.id
WHERE kind_id = 1 AND production_year = 1960
  AND mi.info_type_id = 1 AND mi2.info = 'USA'
  AND mii.info_type_id = 100
  AND mii.info > 100000
  ORDER BY mii.info DESC;")
```

```{r}
sql_1980_data <- db %>%
dbGetQuery("SELECT t.title, t.production_year, 
mi.movie_id,
mii.info_type_id, mii.info 
FROM title t
LEFT JOIN movie_info mi ON mi.movie_id = t.id
LEFT JOIN movie_info mi2 ON mi2.movie_id = t.id
LEFT JOIN movie_info_idx mii ON mii.movie_id = t.id
WHERE kind_id = 1 AND production_year = 1980
  AND mi.info_type_id = 1 AND mi2.info = 'USA'
  AND mii.info_type_id = 100
  AND mii.info > 100000
  ORDER BY mii.info DESC;")
```

```{r}
sql_2000_data <- db %>%
dbGetQuery("SELECT t.title, t.production_year, 
mi.movie_id,
mii.info_type_id, mii.info 
FROM title t
LEFT JOIN movie_info mi ON mi.movie_id = t.id
LEFT JOIN movie_info mi2 ON mi2.movie_id = t.id
LEFT JOIN movie_info_idx mii ON mii.movie_id = t.id
WHERE kind_id = 1 AND production_year = 2000
  AND mi.info_type_id = 1 AND mi2.info = 'USA'
  AND mii.info_type_id = 100
  AND mii.info > 100000
  ORDER BY mii.info DESC;")
```

```{r}
sql_genre_data <- db %>%
dbGetQuery("SELECT mi.info, 
t.title, t.production_year, t.id
FROM title t
JOIN movie_info mi ON t.id = mi.movie_id
WHERE mi.info_type_id = 3
AND t.kind_id = 1;")
```

```{r}
movie_genre_info <- sql_genre_data %>%
  filter(id == 4361365 | id == 4118523 | id == 4260164| id == 3649367)
```

```{r}
genres_info <- movie_genre_info %>%
  group_by(production_year, title) %>%
  summarize(Genre = paste(info, collapse = ','))
```


[We didn't think that graphing the genres for each movie would be more beneficial to the audience than just showing it as is. A graph for information this straight forward seemed counter-productive. We used kable to create mini tables illustrating the genres in each of the movies. However, the caption was not showing up, so we had to create titles for each.] 


```{r warning = FALSE, message = FALSE}
genres_info %>%
  head(4) %>%
  kable(caption = "IMDb Recorded Genres", 
        col.names = c("Production Year", "Movie", "Genres"), 
        align = "l",
        width = "2")
```